"use strict";angular.module("simpleCharts",[]),angular.module("simpleCharts").directive("timeserieschart",function(){return{restrict:"A",scope:{data:"=",options:"="},link:function(scope,element,attributes){var bindTooltip=function(tooltipFormatter){return function(ev,pos,item){item?tooltipContainer.html(tooltipFormatter(item)).css({top:pos.pageY+10,left:pos.pageX+10,border:"1px solid "+item.series.color}).fadeIn(200):tooltipContainer.hide()}},chart=null,defaultOptions={xaxis:{mode:"time",tickFormatter:function(value){return moment(value).format("D.M")}},grid:{hoverable:!0,borderWidth:0},series:{color:"#397ab3",shadowSize:0}};element.addClass("simple-chart-chart"),element.append("<div></div>");var plotContainer=angular.element(element.children()[0]);plotContainer.css({width:element[0].clientWidth,height:element[0].clientHeight});var tooltipContainer=angular.element('<div class="simple-chart-tooltip"></div>');angular.element("body").append(tooltipContainer);var legendContainer=angular.element('<div class="simple-chart-legend"></div>');element.append(legendContainer);var initialize=function(data,options){var options=$.extend(defaultOptions,options||{});data&&(chart?(chart.setData(data),chart.setupGrid(),chart.draw()):(chart=$.plot(plotContainer,data,options),$(plotContainer).bind("plothover",bindTooltip(function(item){return moment(item.datapoint[0]).format("D.M.YYYY")+" : "+item.datapoint[1]}))))};scope.$watch("data",function(data){initialize(data,attributes.options)}),scope.$watch("options",function(options){initialize(attributes.data,options)})}}});